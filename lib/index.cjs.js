"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),e=require("launchdarkly-js-client-sdk"),n=require("lodash.camelcase"),r=require("hoist-non-react-statics");function o(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function i(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var a=i(t),u=o(t),s=o(n),l=o(r),c=function(t,e){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},c(t,e)};function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var p=function(){return p=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},p.apply(this,arguments)};function d(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function u(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))}function v(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var h={useCamelCaseFlagKeys:!0},y=t.createContext({flags:{},ldClient:void 0}),g=y.Provider,b=y.Consumer,C=function(t){var e={};for(var n in t)0!==n.indexOf("$")&&(e[s.default(n)]=t[n]);return e},m=function(t,e,n){var r={};for(var o in t){if(!e||void 0!==e[o])r[n.useCamelCaseFlagKeys?s.default(o):o]=t[o].current}return r},O=function(t,e,n){void 0===e&&(e=h);var r={};if(n)for(var o in n)r[o]=t.variation(o,n[o]);else r=t.allFlags();return e.useCamelCaseFlagKeys?C(r):r};C.camelCaseKeys=C;var w=function(t,n,r,o,i){return void 0===n&&(n={anonymous:!0}),void 0===r&&(r=h),d(void 0,void 0,void 0,(function(){var a,u;return v(this,(function(s){return a=p({wrapperName:"react-client-sdk",wrapperVersion:"2.23.2"},o),u=e.initialize(t,n,a),[2,new Promise((function(t){u.on("ready",(function(){var e=O(u,r,i);t({flags:e,ldClient:u})}))}))]}))}))},x=function(t){function e(e){var n=t.call(this,e)||this;n.getReactOptions=function(){return p(p({},h),n.props.reactOptions)},n.subscribeToChanges=function(t){var e=n.props.flags;t.on("change",(function(t){var r=m(t,e,n.getReactOptions());Object.keys(r).length>0&&n.setState((function(t){var e=t.flags;return{flags:p(p({},e),r)}}))}))},n.initLDClient=function(){return d(n,void 0,void 0,(function(){var t,e,n,r,o,i,a,u,s;return v(this,(function(l){switch(l.label){case 0:return t=this.props,e=t.clientSideID,n=t.flags,r=t.options,o=t.user,i=this.getReactOptions(),[4,w(e,o,i,r,n)];case 1:return a=l.sent(),u=a.flags,s=a.ldClient,this.setState({flags:u,ldClient:s}),this.subscribeToChanges(s),[2]}}))}))};var r=e.options;if(n.state={flags:{},ldClient:void 0},r){var o=r.bootstrap;if(o&&"localStorage"!==o){var i=n.getReactOptions().useCamelCaseFlagKeys?C(o):o;n.state={flags:i,ldClient:void 0}}}return n}return f(e,t),e.prototype.componentDidMount=function(){return d(this,void 0,void 0,(function(){var t,e;return v(this,(function(n){switch(n.label){case 0:return t=this.props,e=t.user,t.deferInitialization&&!e?[2]:[4,this.initLDClient()];case 1:return n.sent(),[2]}}))}))},e.prototype.componentDidUpdate=function(t){return d(this,void 0,void 0,(function(){var e,n,r,o;return v(this,(function(i){switch(i.label){case 0:return e=this.props,n=e.user,r=e.deferInitialization,o=!t.user&&n,r&&o?[4,this.initLDClient()]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},e.prototype.render=function(){return a.createElement(g,{value:this.state},this.props.children)},e}(a.Component);exports.LDProvider=x,exports.asyncWithLDProvider=function(e){return d(this,void 0,void 0,(function(){var n,r,o,i,a,s,l,c;return v(this,(function(f){switch(f.label){case 0:return n=e.clientSideID,r=e.user,o=e.flags,i=e.options,a=e.reactOptions,s=p(p({},h),a),[4,w(n,r,s,i,o)];case 1:return l=f.sent().ldClient,c=function(e){var n=e.children,r=t.useState({flags:O(l,s,o),ldClient:l}),a=r[0],c=r[1];return t.useEffect((function(){if(i){var t=i.bootstrap;if(t&&"localStorage"!==t){var e=s.useCamelCaseFlagKeys?C(t):t;c((function(t){return p(p({},t),{flags:e})}))}}l.on("change",(function(t){var e=m(t,o,s);Object.keys(e).length>0&&c((function(t){return p(p({},t),{flags:p(p({},t.flags),e)})}))}))}),[]),u.default.createElement(g,{value:a},n)},[2,c]}}))}))},exports.camelCaseKeys=C,exports.useFlags=function(){return t.useContext(y).flags},exports.useLDClient=function(){return t.useContext(y).ldClient},exports.withLDConsumer=function(t){return void 0===t&&(t={clientOnly:!1}),function(e){return function(n){return a.createElement(b,null,(function(r){var o=r.flags,i=r.ldClient;return t.clientOnly?a.createElement(e,p({ldClient:i},n)):a.createElement(e,p({flags:o,ldClient:i},n))}))}}},exports.withLDProvider=function(t){return function(e){var n=t.reactOptions,r=p(p({},h),n),o=p(p({},t),{reactOptions:r}),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return f(n,t),n.prototype.render=function(){return a.createElement(x,p({},o),a.createElement(e,p({},this.props)))},n}(a.Component);return l.default(i,e),i}};
//# sourceMappingURL=index.cjs.js.map
